# coding: utf-8

from inspect import getsource
from datetime import datetime

from OpenSSL.crypto import FILETYPE_PEM, TYPE_RSA, X509, PKey, dump_privatekey, dump_certificate

key = PKey()
key.generate_key(TYPE_RSA, 4096)

cert = X509()
issuer = cert.get_issuer()
subject = cert.get_subject()

for dn in [issuer, subject]:
    dn.C = b"TR"
    dn.ST = b"Çorum"
    dn.L = b"Başmakçı"
    dn.CN = b"localhost"
    dn.O = b"Twisted Matrix Labs"
    dn.OU = b"Automated Testing Authority"
    dn.emailAddress = b"security@twistedmatrix.com"

cert.set_serial_number(datetime.now().toordinal())
cert.gmtime_adj_notBefore(0)
cert.gmtime_adj_notAfter(60 * 60 * 24 * 365 * 100)

cert.set_pubkey(key)
cert.sign(key, b"sha1")

import __main__
source = getsource(__main__)
source = source.split(b"\n" + b"-" * 5)[0].rsplit(b"\n", 1)[0]
with open(b"server.pem", "wb") as fObj:
    fObj.write(source)
    fObj.write(b"\n")
    fObj.write(b"'''\n")
    fObj.write(dump_privatekey(FILETYPE_PEM, key))
    fObj.write(dump_certificate(FILETYPE_PEM, cert))
    fObj.write(b"'''\n")
'''
-----BEGIN PRIVATE KEY-----
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
Z5DyS1HYJ/8MySMsRKbjVPie298UU8Gc
-----END PRIVATE KEY-----
-----BEGIN CERTIFICATE-----
MIIF6DCCA9ACAws8kDANBgkqhkiG9w0BAQUFADCBtzELMAkGA1UEBhMCVFIxDzAN
BgNVBAgMBsOHb3J1bTEUMBIGA1UEBwwLQmHFn21ha8OnxLExEjAQBgNVBAMMCWxv
Y2FsaG9zdDEcMBoGA1UECgwTVHdpc3RlZCBNYXRyaXggTGFiczEkMCIGA1UECwwb
QXV0b21hdGVkIFRlc3RpbmcgQXV0aG9yaXR5MSkwJwYJKoZIhvcNAQkBFhpzZWN1
cml0eUB0d2lzdGVkbWF0cml4LmNvbTAgFw0xNzAzMTIwODIwMjBaGA8yMTE3MDIx
NjA4MjAyMFowgbcxCzAJBgNVBAYTAlRSMQ8wDQYDVQQIDAbDh29ydW0xFDASBgNV
BAcMC0JhxZ9tYWvDp8SxMRIwEAYDVQQDDAlsb2NhbGhvc3QxHDAaBgNVBAoME1R3
aXN0ZWQgTWF0cml4IExhYnMxJDAiBgNVBAsMG0F1dG9tYXRlZCBUZXN0aW5nIEF1
dGhvcml0eTEpMCcGCSqGSIb3DQEJARYac2VjdXJpdHlAdHdpc3RlZG1hdHJpeC5j
b20wggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQC9NXLadNeT94rY9Ycj
2Iw6XgtJk9kgtE9dY0ghX3dRbaW2yRE2H2NcmsdbPcfRi3PKDIrv/hkH3y5wkJ7Q
MqQJN/htSxtvCDqyEELqFuu+yTNDOMwEzpvoyEhRHfX6G2S1CvKnS795w1QTixVM
okDlj8B/ykUaPHlxeTAcPuxrLWtyok3UxQAJ9ICe/tjwBm92/gEk8QqadU4t07k1
L6+g7puuJD2P5Bk//jkf4K4LhpIrVEv6hN7Ze3ZooWiiVN+0sV5/pKwW7uO5s0gO
qgby3NC/sz+s3aqvCMLHqzUT4+s2lXVOmmfHoWHna2YZBpeeQQdh4Fm+cFlUTL2X
YJ5J8xIgEAhlcJ3MDfmXNN2OwzS24VYzy67BtwGf+X7kk7LrG3lD7T2anCQV8APi
RzPlRu7/NybSlxaUAK18KcOmzzcXVY9zo29IjwKw0BMbUt2yowb2zZO2p66qE9Gx
DnYKEpKYvdYE9CBRJmxqdLHyvPTsU60DvVw45+1e7liU+Sje/kCvGHJ+t2c/Bl5R
vqBxgNdPU0zJmM3kwbCL9uq+c/PIsswJjlDoDhXhnXqmP9O1AyA7yn3YcLNevxOw
hxW5v4U4ZsaXKD/2fKxcuwPM/OuUoE0tD9iU+zFWzWJ/P+PDLeLejERUyRRZY/dr
2BQvaeyVLDJQb6Aqh5wb24c2xQIDAQABMA0GCSqGSIb3DQEBBQUAA4ICAQBHFU54
UUwh+MbCAMOSvkbmf+Xe+bKNNjFMZwShtJ9nKXw1B8ijx+h2A4KnEXDOlcI2D9wl
JY35Mt5bHxMMrqwx41oAfdMdpFGk4RkzYZazg93uVCVPH3WFqoPJp/RVD6m8NTk3
mt9n62/PIpFD+1qVVpOGknl4MnoMovi+IKKZKMy8U9YT6Okj+ySaRSVIOz2cHp7l
8HG0jZPyyRs56oD6vSk3Wgnmspt3nBgr87PUH2/2hFuXadDagG/b4MRv9+PtJCSu
25ZHuQEEgZShNRn+SyhHUrzQYh0U/XDe4CNJB7hrQvKafhFl90IGYqv9+ejce7+v
fFryNIz9UeKZPhUSnClArtliZutdAsT7GWzT1ahln+vS9Uq9E5WiGlxJJhe+eXoT
fCvTd/HoTdy7gg0w6SaTcymBO71wwlpQ8luXcfI6bHkb1Y2APGKmKdiNC9gdgHSD
0ws4np2vqsVLK3oa/8tzYdmE7bOnveJE6RU8L+sdOCFZxnV3yuGaslcHo2mq+807
i7pk57LvH2ImziC2LfURdTo2lBgpIN8vyMfAIMkgWVHBP46+NtC8ojtA2xLKG8bQ
U5C4yFF2rYRnIDNKiq3RNjjgUyk3cj7wZCrSbREW1nWgYf1s+KoZUiLBP5tab89h
Nqm3DrP1OHbjxE2KcyAlr8DJx29SXcYvZ10ugA==
-----END CERTIFICATE-----
'''
